<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta name=google-site-verification  content=JkqfTj31_AHIEGyz7MqBpq-ziKqWLmPzlFGWQpiHoF4  /> <link rel=preconnect  href="https://fonts.googleapis.com"> <link rel=preconnect  href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet > <script> MathJax = { loader: {load: ['[tex]/ams']}, tex: { inlineMath: [['\\(', '\\)'], ['$', '$']], packages: {'[+]':['base', 'ams', 'color', 'physics']}, tags: 'all' }, svg: {fontCache: 'global'} }; </script> <script id=MathJax-script  async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script> <link rel=stylesheet  href="/css/jtd.css"> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet > <link rel=stylesheet  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" /> <style> /* #148 wrap long header */ .franklin-content a.header-anchor, .franklin-toc li a { word-wrap: break-word; white-space: normal; } </style> <title>Percolation</title> <div class=page-wrap > <div class=side-bar > <div class=header > <a href="/" class=title > <b>Junkai Dong</b> </a> </div> <label for=show-menu  class=show-menu ><span class=material-symbols-outlined >menu</span></label> <input type=checkbox  id=show-menu  role=button > <div class=menu  id=side-menu > <ul class=menu-list > <li class="menu-list-item "><a href="/" class="menu-list-link ">Home</a> <li class="menu-list-item "><a href="/music/" class="menu-list-link ">Music</a> <li class="menu-list-item "><a href="/physics/" class="menu-list-link ">Misc. Physics</a> <ul class=menu-list-child-list > <li class=menu-list-item ><a href="/physics/percolation/" class=menu-list-link >Percolation</a> <li class=menu-list-item ><a href="/physics/ferromagnetism/" class=menu-list-link >Ferromagnetism</a> <li class=menu-list-item ><a href="/physics/orthogonalitycatastrophe/" class=menu-list-link >Orthogonality Catastrophe</a> <li class=menu-list-item ><a href="/physics/Gel'fand-Yaglom/" class=menu-list-link >Gel'fand-Yaglom</a> <li class=menu-list-item ><a href="/physics/Lieb/" class=menu-list-link >Lieb's Lieder</a> <li class=menu-list-item ><a href="/physics/Reshetikhin-Turaev" class=menu-list-link >RT Invariant</a> <li class=menu-list-item ><a href="/physics/Kane-Fisher-Polchinski" class=menu-list-link >Taming Edgy Currents by Disorder</a> <li class=menu-list-item ><a href="/physics/firstpassage" class=menu-list-link >First Passage</a> <li class=menu-list-item ><a href="/physics/#short_notes" class=menu-list-link >Short Notes</a> </ul> </ul> </div> <div class=footer > This is <em>Just the docs</em>, adapted from the <a href="https://github.com/pmarsceill/just-the-docs" target=_blank >Jekyll theme</a>. </div> </div> <div class=main-content-wrap > <div class=main-content > <div class=franklin-content ><h2 id="percolation_in_the_erdősrényi_model_and_beyond"><a href="#percolation_in_the_erdősrényi_model_and_beyond" class=header-anchor >Percolation in the Erdős–Rényi model, and beyond</a></h2> <p>This set of notes is created to procrastinate the production scientific results and to relive the excitement I felt during PHYS 7653, advanced statistical mechanics, taught by Prof. Veit Elser in Fall 2019.</p> <div class=franklin-toc ><ol><li><a href="#model">Model</a><li><a href="#calculations_on_small_clusters">Calculations on small clusters</a><li><a href="#percolation_transition">Percolation transition</a><ol><li><a href="#lambert_w_function">Lambert W function</a></ol><li><a href="#duality">Duality</a><li><a href="#bec_as_a_graph_model">BEC as a graph model</a><li><a href="#references">References</a></ol></div> <h3 id=model ><a href="#model" class=header-anchor >Model</a></h3> <p><a href="https://doi.org/10.5486&#37;2FPMD.1959.6.3-4.12">The model</a> is introduced by two mathematical giants, Paul Erdős and Alfréd Rényi in 1960. It has the following inputs:</p> <ol> <li><p>a set of \(n\) points as vertices.</p> <li><p>a probability \(p=\frac{d}{n-1}\) which describes the probability of having an edge between any pair of vertices.</p> </ol> <p>Note that the model lives in \(0\) dimensions: there is no embedding into a manifold. We are interested in the limit where \(n\to\infty\) and \(d\) fixed. The probability is defined such that \(\left\langle \textrm{degree of any given vertex} \right\rangle=d\). Macroscopically, this model describes a set of graphs.</p> <h3 id=calculations_on_small_clusters ><a href="#calculations_on_small_clusters" class=header-anchor >Calculations on small clusters</a></h3> <p>A simple calculation we can do is the distribution of degree for a given vertex:</p> \[P(k)=\binom{n-1}{k}p^k(1-p)^{n-1-k}.\] <p>Taking the limit of \(n\to\infty\) and using Stirling&#39;s approximation, we find that the probability reduces to a Poisson distribution:</p> \[P(k)\to \frac{d^k}{k!}e^{-d}.\] <p>We want to calculate some more interesting quantities, say the number of triangles in the system. To do this, let&#39;s define \(S_\Delta\) to be the set of all triples in the system: \(|S_{\Delta}|=\binom{n}{3}\). Define the indicator \(\theta(t)\) to be \(1\) if \(t\) is a triangle and \(0\) if not. Since all triplets in the system are equivalent,</p> \[\left\langle N_\Delta \right\rangle = \sum_t {\theta(t)}=|S_{\Delta}|\left\langle \theta(t_0) \right\rangle=|S_{\Delta}|p_{t_0=\Delta}.\] <p>Given \(t_0\), if it is indeed a triangle, then its three edges have to be connected; also, its three vertices cannot be connected to any other vertex. Hence, \(p_{t_0=\Delta}=p^3(1-p)^{3(n-3)},\) which yields </p> \[\left\langle N_\Delta \right\rangle\sim d^3e^{-3d}.\] <p>One can similarly calculate the expected number for any other graph with \(V\) vertices and \(E\) edges. One will find that </p> \[\left\langle N \right\rangle\sim n^{V-E}e^{-Vd}.\] <p>Through this calculation, we find that forming cycles are costly: the only subgraphs whose quantities scale linearly with \(n\) are trees.</p> <p>All the graphs we studied before are finite, small clusters compared to the system size \(n\): there might be the case where there exists a cluster whose size scales linearly with \(n\). When this happens, we say that the system <strong>percolates</strong>. The central question to ask in this note is: <strong>when will the system percolate?</strong></p> <p>At this moment, the readers informed in physics should feel the plug in their stomach: this vaguely has the flavor of asking when a bosonic system will condense. This will be made more precise in a later section. The physical approach we often take on BECs is that, we calculate the thermal distribution of bosonic particles and see if the thermal distribution can take all the particles; if it can&#39;t take all the particles, the amount that overflows &#40;which is a macroscopic quantity&#41; condenses into the ground state. We will ask a similar question here: <strong>What fraction of vertices are in finite clusters as \(n\to\infty\)?</strong></p> <h3 id=percolation_transition ><a href="#percolation_transition" class=header-anchor >Percolation transition</a></h3> <p>As we have shown above, as \(n\to\infty\), the most important contributions to these clusters come from trees. Let&#39;s calculate the number of trees of size \(k\), \(n_k\). Similar to before, we take the set of all \(k\)-tuples and calculate the expectation that they form trees. For a particular tree configuration in a particular tuple, the probability is \(p^{k-1} e^{-kd}\); for a particular cluster \(k\), there are \(k^{k-2}\) different labeled trees. In the end, the expected number of trees with size \(k\) is</p> \[\left\langle n_k \right\rangle=\binom{n}{k}p^{k-1} e^{-kd}k^{k-2}=\frac{n}{d}\frac{k^{k-2}}{k!}(de^{-d})^k.\] <p>Let \(f\) be the fraction of vertices in finite clusters, similar to the fraction of particles not in the condensate. </p> \[f=\frac{1}{n}\sum_{k=1}^\infty k\left\langle n_k \right\rangle=\frac{1}{d}\sum_{k=1}^\infty \frac{k^{k-1}}{k!}(de^{-d})^k=\frac{1}{d}W(de^{-d})\] <p>where \(W\) is the Lambert \(W\) function. Although there are many conventions, here we take the convention where \(W(de^{-d})=d\). Hence \(f=1\) and there is no percolation. The reader is now advised to leave the website, for they seem to have wasted some of their precious time and should avoid further sunken cost.</p> <p>What is wrong with the calculation before? One - physically we know that the calculation can&#39;t be right. In the limit \(d\gg0\), almost all vertices should be in the same cluster. Two - mathematically the treatment is not rigorous: the Lambert \(W\) function isn&#39;t really well defined as we have written it&#33;</p> <h4 id=lambert_w_function ><a href="#lambert_w_function" class=header-anchor >Lambert W function</a></h4> <p>Note that the Lambert \(W\) function is defined as the inverse of the function \(de^{-d}\): that is, \(W(d)e^{-W(d)}=de^{-d}\).</p> <figure style="text-align:center;"> <img src="/assets/physics/percolation/invW.png" style="padding:0; width:500px" alt=" invW"/> </figure> <p>However, the inverse is <em>not</em> well defined: the equation \(de^{-d}=0.25\) has two solutions, \(d_1=0.36\) and \(d_2=2.15\). Which branch are we picking? Does \(W(0.25)\) equal to \(0.36\) or \(2.15\)? We define \(\tilde{d}(d)\) to be the other solution of \(\tilde{d}e^{-\tilde{d}}=de^{-d}\).</p> <p>To make sure that \(W(0)=0\), we will pick the branch related to \(d_1\); that is, the branch with smaller \(d\) values. Now \(W(x)\) is only defined on \([0,1/e]\) whose values run from \(0\) to \(1\). Hence, the function \(W(d e^{-d})\) has the following definition:</p> \[W(de^{-d})=\left\{ \begin{aligned}&d,\quad d\leq 1\\&\tilde{d}(d),\quad d\geq 1\end{aligned}\right.\] <p>This means that our calculation of \(f\) – number of vertices in small clusters – is actually not correct. It will be</p> \[f=\frac{W(de^{-d})}{d}=\left\{ \begin{aligned}&1,\quad d\leq 1\\&\frac{\tilde{d}(d)}{d},\quad d\geq 1\end{aligned}\right.\] <p> <figure style="text-align:center;"> <img src="/assets/physics/percolation/fvsd.png" style="padding:0; width:500px" alt=" fvsd"/> </figure> We see a clear transition: the system percolates when \(d\geq 1\). There is an extensive amount of particles that do not live in small clusters; they must live in a huge cluster that has size of order \(n\).</p> <h3 id=duality ><a href="#duality" class=header-anchor >Duality</a></h3> <p>Since \(W(de^{-d})=W(\tilde{d}e^{-\tilde{d}})\), it is natural to suspect that the system will behave similarly although we have different values for \(d\). To see that, we consider the following quantity: let \(s\) be the size of tree a vertex belongs to, <em>averaged over vertices in finite clusters</em>. Define \(z=de^{-d}\). By construction,</p> \[s=\frac{\sum_{k=1}^\infty k(k\cdot n_k)}{\sum_{k=1}^\infty k n_k}=\frac{zW'(z)}{W(z)}.\] <p>Given that \(z=W(z)e^{-W(z)}\), \(W'=\frac{e^W}{1-W}\). Hence </p> \[s=\frac{1}{1-W(z)}=\left\{ \begin{aligned}&\frac{1}{1-d},\quad d\leq 1\\&\frac{1}{1-\tilde{d}},\quad d\geq 1\end{aligned}\right.\] <p>We hence see the duality: at either \(d\) or \(\tilde{d}\), the system exhibits the same behavior, except for the percolating cluster.</p> <h3 id=bec_as_a_graph_model ><a href="#bec_as_a_graph_model" class=header-anchor >BEC as a graph model</a></h3> <p>I would like to sketch how BEC becomes a graph model. Consider the partition function of \(N\) bosons: </p> \[{\mathcal Z}=\textrm{Tr}e^{-\beta H}\sim\sum_{p\in S_N}\int\prod_{i=1}^N d^3r_i\left\langle r_1\dots r_N|e^{-\beta H}|r_{p(1)}\dots r_{p(N)} \right\rangle.\] <p>Forgetting all the macroscopic details, we can try to study the structure of the permutation \(p\). Which kinds of permutations dominate the sum? It is not unimaginable that when BEC condensation happens, the sum is dominated by permutations containing a cycle of length order \(n\) - this is called cycle percolation, and it has been studied intensively<sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup><sup id="fnref:2"><a href="#fndef:2" class=fnref >[2]</a></sup>.</p> <h3 id=references ><a href="#references" class=header-anchor >References</a></h3> <p><table class=fndef  id="fndef:1"> <tr> <td class=fndef-backref ><a href="#fnref:1">[1]</a> <td class=fndef-content >A. Suto, Percolation transition in the Bose gas &#40;1993&#41;. <a href="https://doi.org/10.1088/0305-4470/26/18/031">DOI</a> </table> <table class=fndef  id="fndef:2"> <tr> <td class=fndef-backref ><a href="#fnref:2">[2]</a> <td class=fndef-content >A. Suto, Percolation transition in the Bose gas II &#40;2002&#41;. <a href="https://arxiv.org/abs/cond-mat/0204430">arXiv</a> </table> </p> <div class=page-foot > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Junkai Dong. Last modified: July 08, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <!-- end of class page-wrap-->